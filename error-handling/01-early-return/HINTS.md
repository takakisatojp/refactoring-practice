# ãƒ’ãƒ³ãƒˆé›†

## å•é¡Œã®è§£ãæ–¹

ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ãƒ’ãƒ³ãƒˆã‚’æ®µéšçš„ã«æä¾›ã—ã¾ã™ã€‚
å®Œå…¨ãªç­”ãˆã‚’è¦‹ãŸã„å ´åˆã¯ã€`good.ts` ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

---

## ãƒ’ãƒ³ãƒˆ 1: ã‚¬ãƒ¼ãƒ‰å¥ã®è€ƒãˆæ–¹

**ğŸ’¡ è€ƒãˆæ–¹**

ã€Œæ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã€ã¯ã€Œã‚¬ãƒ¼ãƒ‰å¥ï¼ˆGuard Clauseï¼‰ã€ã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚

```
å¾“æ¥ã®ã‚„ã‚Šæ–¹ï¼ˆãƒã‚¹ãƒˆãŒæ·±ã„ï¼‰:
if (æ¡ä»¶A) {
  if (æ¡ä»¶B) {
    if (æ¡ä»¶C) {
      âœ… æœ¬æ¥ã®å‡¦ç†
    } else {
      âŒ ã‚¨ãƒ©ãƒ¼C
    }
  } else {
    âŒ ã‚¨ãƒ©ãƒ¼B
  }
} else {
  âŒ ã‚¨ãƒ©ãƒ¼A
}

æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã®ã‚„ã‚Šæ–¹ï¼ˆãƒã‚¹ãƒˆãŒæµ…ã„ï¼‰:
if (!æ¡ä»¶A) return âŒ ã‚¨ãƒ©ãƒ¼A
if (!æ¡ä»¶B) return âŒ ã‚¨ãƒ©ãƒ¼B
if (!æ¡ä»¶C) return âŒ ã‚¨ãƒ©ãƒ¼C

âœ… æœ¬æ¥ã®å‡¦ç†
```

**ãƒã‚¤ãƒ³ãƒˆ**
- ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã‚’ **æœ€åˆã«** ãƒã‚§ãƒƒã‚¯
- æ¡ä»¶ã‚’ **å¦å®šå½¢** ã§æ›¸ãï¼ˆ`if (user)` ã§ã¯ãªã `if (!user)`ï¼‰
- ã‚¨ãƒ©ãƒ¼ãªã‚‰å³åº§ã«è¿”ã™
- ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚¯ãƒªã‚¢ã—ãŸã‚‰ã€æœ¬æ¥ã®å‡¦ç†ã‚’å®Ÿè¡Œ

---

## ãƒ’ãƒ³ãƒˆ 2: æ¡ä»¶ã®è¦‹ç›´ã—

**ğŸ’¡ è¦‹ç›´ã™ã¹ãæ¡ä»¶**

`bad.ts` ã§ã¯ä»¥ä¸‹ã®4ã¤ã®æ¡ä»¶ãŒãƒã‚¹ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼š
1. `user` ãŒå­˜åœ¨ã™ã‚‹ã‹
2. `user.email` ãŒå­˜åœ¨ã™ã‚‹ã‹
3. `user.email` ã« `@` ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹
4. `user.age` ãŒ 0 ã‚ˆã‚Šå¤§ãã„ã‹

**æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—**

```typescript
export function validateUserInput(user: any): ValidationResult {
  // ã‚¹ãƒ†ãƒƒãƒ— 1: user ã®ãƒã‚§ãƒƒã‚¯
  if (!user) {
    return { isValid: false, message: 'User object is required' };
  }

  // ã‚¹ãƒ†ãƒƒãƒ— 2: email ã®å­˜åœ¨ãƒã‚§ãƒƒã‚¯
  if (!user.email) {
    return { isValid: false, message: 'Email is required' };
  }

  // ã‚¹ãƒ†ãƒƒãƒ— 3: email ã®å½¢å¼ãƒã‚§ãƒƒã‚¯
  if (!user.email.includes('@')) {
    return { isValid: false, message: 'Email must contain @' };
  }

  // ã‚¹ãƒ†ãƒƒãƒ— 4: age ã®ãƒã‚§ãƒƒã‚¯
  if (!user.age || user.age <= 0) {
    return { isValid: false, message: 'Age must be greater than 0' };
  }

  // âœ… ã™ã¹ã¦OK â†’ æ­£å¸¸ç³»ã®å‡¦ç†
  return { isValid: true, message: 'User input is valid' };
}
```

---

## ãƒ’ãƒ³ãƒˆ 3: ãƒã‚¹ãƒˆã®æ·±ã•ã‚’æ•°ãˆã‚‹

**ğŸ’¡ æ”¹å–„ã®ç¢ºèª**

æ”¹å–„å‰å¾Œã§ãƒã‚¹ãƒˆã®æ·±ã•ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

**æ”¹å–„å‰ï¼ˆbad.tsï¼‰**
```
if (user) {                           // ãƒã‚¹ãƒˆæ·±ã•: 1
  if (user.email) {                   // ãƒã‚¹ãƒˆæ·±ã•: 2
    if (user.email.includes('@')) {   // ãƒã‚¹ãƒˆæ·±ã•: 3
      if (user.age > 0) {             // ãƒã‚¹ãƒˆæ·±ã•: 4
        // âœ… æœ¬æ¥ã®å‡¦ç†
      } else {
        // âŒ ã‚¨ãƒ©ãƒ¼å‡¦ç†
      }
    } else {
      // âŒ ã‚¨ãƒ©ãƒ¼å‡¦ç†
    }
  } else {
    // âŒ ã‚¨ãƒ©ãƒ¼å‡¦ç†
  }
} else {
  // âŒ ã‚¨ãƒ©ãƒ¼å‡¦ç†
}
```

**æ”¹å–„å¾Œï¼ˆgood.tsï¼‰**
```
// ã‚¬ãƒ¼ãƒ‰å¥ 1
if (!user) {  // ãƒã‚¹ãƒˆæ·±ã•: 1
  return ...
}

// ã‚¬ãƒ¼ãƒ‰å¥ 2
if (!user.email) {  // ãƒã‚¹ãƒˆæ·±ã•: 1
  return ...
}

// ã‚¬ãƒ¼ãƒ‰å¥ 3
if (!user.email.includes('@')) {  // ãƒã‚¹ãƒˆæ·±ã•: 1
  return ...
}

// ã‚¬ãƒ¼ãƒ‰å¥ 4
if (!user.age || user.age <= 0) {  // ãƒã‚¹ãƒˆæ·±ã•: 1
  return ...
}

// âœ… æœ¬æ¥ã®å‡¦ç†  // ãƒã‚¹ãƒˆæ·±ã•: 0
```

**ãƒ¡ãƒªãƒƒãƒˆ**
- ãƒã‚¹ãƒˆã®æœ€å¤§æ·±ã•ãŒ **4 â†’ 1** ã«å‰Šæ¸›
- å„æ¡ä»¶ã®èª­ã¿æ–¹ãŒç›´ç·šçš„ã«ãªã‚‹
- æœ¬æ¥ã®å‡¦ç†ãŒæœ€å¾Œã«æ¥ã‚‹ã®ã§ã€èª­ã¿æµã—ã‚„ã™ã„

---

## å®Ÿè£…ã®ã‚³ãƒ„

### æ¡ä»¶ã‚’å¦å®šå½¢ã§æ›¸ãç†ç”±

```typescript
// âŒ é¿ã‘ã‚‹ã¹ãï¼ˆè‚¯å®šå½¢ï¼‰
if (user) {
  if (user.email) {
    // ...æœ¬æ¥ã®å‡¦ç†...
  }
}

// âœ… æ¨å¥¨ï¼ˆå¦å®šå½¢ + æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ï¼‰
if (!user) {
  return error;
}
if (!user.email) {
  return error;
}
// âœ… æœ¬æ¥ã®å‡¦ç†
```

**ç†ç”±**
- ã‚¨ãƒ©ãƒ¼ã‚’å³åº§ã«è­˜åˆ¥ã§ãã‚‹
- ãƒã‚¹ãƒˆãŒæ·±ããªã‚‰ãªã„
- ç•°å¸¸ç³»ã¨æ­£å¸¸ç³»ãŒè¦–è¦šçš„ã«åˆ†é›¢ã•ã‚Œã‚‹

---

## ãƒ†ã‚¹ãƒˆã§å‹•ä½œç¢ºèª

å®Ÿè£…å¾Œã€ãƒ†ã‚¹ãƒˆã§å‹•ä½œç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

```bash
npm test error-handling/01-early-return/test.test.ts
```

ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°OKï¼

---

**æº–å‚™ãŒã§ããŸã‚‰ã€`good.ts` ã‚’é–‹ã„ã¦ã€è‡ªåˆ†ã®å®Ÿè£…ã¨æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚**
